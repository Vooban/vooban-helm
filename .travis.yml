---
language: generic

dist: trusty
sudo: false

env:
  global:
    - HELM_VERSION="v2.12.3"
    - USER="Travis CI"
    - EMAIL="travis-ci@vooban.com"
    - REPO="vooban-helm"
    - FILES="README.md foo.txt bar.txt"
    - GH_REPO="github.com/vooban/vooban-helm.git"
    - secure: "put travis gem output here => http://docs.travis-ci.com/user/encryption-keys/"

install:
  - wget http://storage.googleapis.com/kubernetes-helm/helm-${HELM_VERSION}-linux-amd64.tar.gz -O /tmp/helm.tar.gz
  - tar xzf /tmp/helm.tar.gz -C /tmp --strip-components=1
  - chmod +x /tmp/helm

before_script:
  - /tmp/helm init --client-only
  - /tmp/helm repo add vooban https://vooban.github.io/vooban-helm
script:
  - /tmp/helm lint */
  - /tmp/helm package */
  - /tmp/helm repo index --merge index.yaml .
  - git add .
  - git commit -m "Chart update [skip ci]"
  - branch_name=`git rev-parse --abbrev-ref HEAD`
  - git push origin $branch_name